# ü¶à Gu√≠a Esencial de Wireshark para Blue Team üõ°Ô∏è (Principiantes)

¬°Hola! üëã Bienvenido/a a esta gu√≠a de referencia r√°pida ("cheat sheet") de **Wireshark**, la herramienta indispensable para cualquier profesional del an√°lisis de redes. Este documento est√° optimizado para **principiantes** que dan sus primeros pasos en el **Blue Team** (ciberseguridad defensiva).

> **¬øPor qu√© Wireshark es Clave en Blue Team?**
> Wireshark te da **visibilidad** sobre el tr√°fico de tu red. Es fundamental para:
> * Investigar alertas de seguridad (IDS/IPS, SIEM).
> * Diagnosticar problemas de conectividad y rendimiento.
> * Comprender las fases de un ataque (reconocimiento, C2, exfiltraci√≥n).
> * Verificar pol√≠ticas de firewall.
> * En resumen: **defender tus activos digitales con conocimiento.**

---

## üîç Anatom√≠a de la Interfaz de Wireshark

Al iniciar Wireshark y cargar una captura, estas son las √°reas principales que encontrar√°s:
*(Una captura de pantalla aqu√≠ es altamente recomendada üëá)*

1.  **Barra de Men√∫s y Herramientas:** Acceso a todas las funciones y opciones.
2.  **Barra de Filtros de Visualizaci√≥n:** ¬°Tu centro de comandos! Aqu√≠ aplicas filtros para encontrar lo relevante.
3.  **Lista de Paquetes:** El coraz√≥n de Wireshark. Cada fila representa un paquete capturado.
4.  **Detalles del Paquete:** Desglose jer√°rquico (por capas OSI/TCP) del paquete seleccionado.
5.  **Bytes del Paquete:** Contenido crudo del paquete en hexadecimal y ASCII.

**Columnas T√≠picas en la Lista de Paquetes:**

| Columna    | Descripci√≥n                                                      |
| :--------- | :--------------------------------------------------------------- |
| **No.** | #Ô∏è‚É£ Identificador secuencial √∫nico del paquete en esta captura. |
| **Time** | üïí Timestamp relativo al inicio de la captura (o absoluto).   |
| **Source** | ‚û°Ô∏è Direcci√≥n Origen (IP, MAC, etc.).                            |
| **Dest.** | ‚¨ÖÔ∏è Direcci√≥n Destino (IP, MAC, etc.).                           |
| **Protocol**| üìú El protocolo de m√°s alto nivel identificado (HTTP, DNS, TCP...). |
| **Length** | üìè Longitud total del paquete en bytes.                          |
| **Info** | ‚ÑπÔ∏è Resumen contextual √∫til (Flags TCP, URL, consulta DNS...).    |

---

## üî¨ Filtrado: El Arte de Encontrar la Aguja en el Pajar

Wireshark puede capturar gigabytes de datos r√°pidamente. Sin filtros, analizar es casi imposible.

> **Filtros de Captura vs. Filtros de Visualizaci√≥n: La Diferencia Clave**
>
> * **Filtros de Captura:** Se configuran *antes* de iniciar la captura. Definen qu√© paquetes se guardar√°n en el archivo `.pcapng`. Son **menos flexibles** una vez iniciada la captura y usan una **sintaxis diferente** (basada en BPF, ej: `host 1.2.3.4`, `port 80`, `tcp and not port 22`). √ötiles para descartar ruido masivo en capturas largas.
> * **Filtros de Visualizaci√≥n:** Se aplican *sobre la marcha* a los paquetes ya capturados (o al abrir un archivo). Permiten **mostrar/ocultar paquetes din√°micamente** sin modificar la captura original. Son **extremadamente potentes y flexibles**, y son los que **usar√°s el 95% del tiempo para analizar**. **Esta gu√≠a se centra en ellos.**
> *(Una captura mostrando la barra de filtros en acci√≥n es ideal aqu√≠ üëá)*

### Operadores para Filtros de Visualizaci√≥n

Construye tus filtros combinando **campos** (ej: `ip.addr`, `tcp.port`, `dns.qry.name`) con **operadores**:

**Operadores de Comparaci√≥n:**

| Operador   | Ejemplo                   | Descripci√≥n                                    |
| :--------- | :------------------------ | :--------------------------------------------- |
| `==`       | `ip.addr == 1.1.1.1`      | Igual a (valor exacto)                         |
| `!=`       | `tcp.port != 80`          | Diferente de                                   |
| `>`        | `frame.len > 1000`        | Mayor que                                      |
| `<`        | `udp.port < 1024`         | Menor que                                      |
| `>=`       | `ip.ttl >= 64`            | Mayor o igual que                              |
| `<=`       | `tcp.window_size <= 14k`  | Menor o igual que                              |
| `contains` | `http contains "admin"`   | El campo (o paquete) contiene la subcadena (case-insensitive por defecto) |
| `matches`  | `dns.qry.name matches "\\d{3}\\.com"` | El campo coincide con una Expresi√≥n Regular (PCRE) |

**Operadores L√≥gicos:**

| Operador     | Ejemplo                                       | Descripci√≥n                                       |
| :----------- | :-------------------------------------------- | :------------------------------------------------ |
| `&&` o `and` | `ip.src == 10.1.1.5 and tcp.dstport == 443`   | **Y L√≥gico:** Ambas condiciones deben ser ciertas. |
| `||` o `or`  | `udp.port == 53 or tcp.port == 53`            | **O L√≥gico:** Al menos una condici√≥n debe ser cierta. |
| `!` o `not`  | `not arp`                                     | **NO L√≥gico:** Invierte la condici√≥n siguiente.    |
| `^^` o `xor` | `tcp.flags.syn == 1 ^^ tcp.flags.ack == 1`    | **O Exclusivo:** Una condici√≥n s√≠, la otra no.      |
| `(...)`      | `(ip.addr == 1.1.1.1 and tcp) or dns`         | **Par√©ntesis:** Para agrupar y controlar precedencia. |

---

## üì° Modos de Captura

* **Modo Promiscuo:** (Activado por defecto en Ethernet cableada) La interfaz de red captura *todo* el tr√°fico que f√≠sicamente llega a ella, incluso si no est√° destinado a su direcci√≥n MAC. Esencial para monitorizar un segmento de red (su efectividad depende de la topolog√≠a de red, especialmente de los switches).
* **Modo Monitor:** (Espec√≠fico para interfaces Wi-Fi, soportado nativamente en Linux/macOS) Permite capturar *todo* el tr√°fico 802.11 en un canal espec√≠fico (incluyendo tramas de gesti√≥n y control) sin necesidad de estar asociado a una red (AP). Clave para auditor√≠as y an√°lisis de seguridad Wi-Fi.

---

## üî• ¬°Filtros Esenciales para Blue Team! üî•

Este es tu kit de inicio de filtros de visualizaci√≥n para an√°lisis defensivo:

| Prop√≥sito                               | Filtro de Ejemplo                               | Notas Defensivas üõ°Ô∏è                                                            |
| :-------------------------------------- | :---------------------------------------------- | :------------------------------------------------------------------------------ |
| **IP Espec√≠fica (Origen o Destino)** | `ip.addr == 1.2.3.4`                            | **Fundamental.** Aislar actividad de IP sospechosa, servidor cr√≠tico, IOC.      |
| **IP Origen** | `ip.src == 10.0.0.50`                           | Analizar todo el tr√°fico *originado* por un host espec√≠fico.                  |
| **IP Destino** | `ip.dst == 8.8.8.8`                             | Analizar todo el tr√°fico *destinado* a un host espec√≠fico (ej. servidor externo). |
| **Subred Completa** | `ip.addr == 192.168.1.0/24`                     | Enfocarse en el tr√°fico dentro (o hacia/desde) un segmento de red local.      |
| **Excluir IP (Eliminar Ruido)** | `not ip.addr == 192.168.1.1`                    | Ignorar tr√°fico conocido y benigno (tu m√°quina, scanners autorizados...).      |
| **Puerto TCP Espec√≠fico** | `tcp.port == 443`                             | Aislar tr√°fico de un servicio (HTTPS, RDP/3389, SSH/22, etc.).                 |
| **Puerto UDP Espec√≠fico** | `udp.port == 53`                              | Aislar tr√°fico DNS (53), NTP (123), SNMP (161/162), etc.                    |
| **Puerto Destino Espec√≠fico** | `tcp.dstport == 3389`                           | Buscar intentos de conexi√≥n *entrantes* a un servicio (RDP en este caso).       |
| **Combinar IP y Puerto** | `ip.addr == 1.2.3.4 and tcp.port == 22`         | **Muy potente.** Investigar conexiones SSH hacia/desde una IP en particular. |
| **Protocolos Clave (Filtrar por Nombre)**| `http` / `dns` / `icmp` / `arp` / `smb` / `dhcp`| Centrarse en protocolos espec√≠ficos para an√°lisis (C2, exfiltraci√≥n, escaneos...). |
| **Buscar Texto en Payload (General)** | `frame contains "password"`                     | ‚ö†Ô∏è **Precauci√≥n:** Puede ser muy lento en capturas grandes. √ötil para encontrar datos sensibles no cifrados o indicadores espec√≠ficos. |
| **TCP SYN (Inicio de Conexi√≥n)** | `tcp.flags.syn == 1 and tcp.flags.ack == 0`     | **Clave para detectar escaneos.** Identifica paquetes de inicio de conexi√≥n.     |
| **TCP RST (Reset/Rechazo)** | `tcp.flags.reset == 1`                          | Indica conexiones rechazadas/abortadas. Puede se√±alar escaneos, firewalls.      |
| **DNS Queries (Consultas de Nombres)** | `dns.flags.response == 0`                       | Ver qu√© nombres de dominio est√°n intentando resolver los hosts.                 |
| **DNS Queries por Nombre Espec√≠fico** | `dns.qry.name contains "malware-domain"`        | Buscar consultas a dominios maliciosos conocidos (IOC).                         |
| **HTTP Requests (GET/POST...)** | `http.request`                                  | Ver todas las solicitudes HTTP (URLs, m√©todos...). √ötil para an√°lisis de C2 web. |
| **Tr√°fico Broadcast (Red Local)** | `eth.dst == ff:ff:ff:ff:ff:ff`                  | Analizar tr√°fico enviado a todos en el segmento (ARP, DHCP Discover...).      |

> **üí° Consejo Profesional:** La verdadera potencia reside en **combinar** estos filtros usando `and`, `or`, `not` y par√©ntesis `()` para aislar exactamente el tr√°fico que necesitas investigar.
> Ejemplo: `(ip.src == 10.1.2.3 and tcp.dstport == 443) and not ip.dst == 1.1.1.1`

---

## ‚å®Ô∏è Atajos de Teclado Imprescindibles

* `Ctrl + E`: Iniciar / Detener la captura activa.
* `Ctrl + R`: Reiniciar la captura activa.
* `Ctrl + F`: Buscar texto dentro de los datos de los paquetes.
* `Ctrl + O`: Abrir un archivo de captura (`.pcapng`, `.pcap`...).
* `Ctrl + S`: Guardar la captura actual (o los paquetes seleccionados).
* `Ctrl + Q`: Salir de Wireshark.
* `Ctrl + Flecha Abajo` (o `F8`): Ir al siguiente paquete en la lista.
* `Ctrl + Flecha Arriba` (o `F7`): Ir al paquete anterior en la lista.
* `Ctrl + G`: Ir a un n√∫mero de paquete espec√≠fico.
* `Ctrl + M`: Marcar/Desmarcar el paquete seleccionado.

---

## ‚öôÔ∏è Barra de Herramientas: Iconos Clave

* **ü¶à Aleta Azul:** Iniciar una nueva captura (usando la √∫ltima configuraci√≥n).
* **üü• Cuadrado Rojo:** Detener la captura activa.
* **ü¶à Aleta Gris:** Reiniciar la captura activa (Detener y volver a Iniciar).
* **üìÇ Carpeta Abierta:** Abrir un archivo de captura existente.
* **üíæ Disquete:** Guardar la captura actual.
* **üîç Lupa:** Encontrar paquetes basados en criterios (filtros, texto...).
* **‚¨ÖÔ∏è / ‚û°Ô∏è Flechas:** Navegar por el historial de selecci√≥n de paquetes.
* **üé® Paleta Colores:** Activar/Desactivar las reglas de coloreado de paquetes (ayuda visual crucial).

---

## ‚¨áÔ∏è Instalaci√≥n y Disponibilidad

* **Descarga Oficial (Todas las plataformas):** [https://www.wireshark.org/download.html](https://www.wireshark.org/download.html)
* > **üí° Nota para Pentesters/Analistas:** Wireshark viene **preinstalado y listo para usar** en la mayor√≠a de distribuciones Linux enfocadas en ciberseguridad, como **Kali Linux** y **Parrot Security OS**.

---

## ‚ùó Consideraciones √âticas Fundamentales

> **‚ö†Ô∏è ¬°ADVERTENCIA SERIA!**
> La captura y an√°lisis de tr√°fico de red puede interceptar comunicaciones privadas y datos sensibles. Realizar estas acciones sin la **autorizaci√≥n expl√≠cita y por escrito** del propietario de la red y/o sistemas implicados es **ilegal** en la mayor√≠a de jurisdicciones y constituye una **grave violaci√≥n √©tica y de privacidad.**
> **Utiliza Wireshark √∫nicamente de forma legal, √©tica y responsable dentro de los l√≠mites de tu autorizaci√≥n.**

---

## ‚ùì Contribuciones y Mejoras

¬øHas encontrado un error, una errata o tienes alguna sugerencia para mejorar esta gu√≠a? ¬°Excelente! Por favor, abre un **Issue** detallado en este repositorio. El objetivo es que este recurso sea lo m√°s √∫til posible para la comunidad.
